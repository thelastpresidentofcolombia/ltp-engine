---
/**
 * Footer Module - Consultancy Skin
 * 
 * ENGINE CONTRACT:
 * - Reads: operator.brand, operator.footer, operator.location, operator.ui.labels.footer
 * - Skin defaults: consultancyDefaults.labels.footer
 * 
 * TOKEN DEPENDENCIES:
 * - --color-bg-inverse, --color-text-inverse
 * - --color-text-muted
 * - --color-border (for divider, mapped to dark variant in inverse context)
 * 
 * VISUAL METAPHOR: Minimal / Swiss-style
 * Clean hierarchy with operator branding.
 */

import { consultancyDefaults } from '../skin';

interface Props {
  operator: any;
  variant?: string;
}

const { operator } = Astro.props;

const brand = operator.brand ?? {};
const footer = operator.footer ?? {};

// === BRAND DATA ===
const operatorName = brand.name ?? 'Operator';
const tagline = footer.tagline ?? brand.tagline ?? '';
const location = footer.location ?? operator.location?.cityName ?? '';
const copyright = footer.copyright ?? `© ${new Date().getFullYear()} ${operatorName}. All rights reserved.`;

// === LINKS (from operator.footer) ===
const links: any[] = footer.links ?? [];
const socialLinks: any[] = footer.social ?? [];
const legalLinks: any[] = footer.legal ?? [];

// === LABELS (operator.ui.labels.footer → skin defaults) ===
const navLabel = operator.ui?.labels?.footer?.nav ?? consultancyDefaults.labels.footer.nav;
const socialLabel = operator.ui?.labels?.footer?.social ?? consultancyDefaults.labels.footer.social;

// Social platform display names (engine-level defaults for accessibility)
const socialLabels: Record<string, string> = {
  linkedin: 'LinkedIn',
  twitter: 'Twitter',
  instagram: 'Instagram',
  youtube: 'YouTube',
  facebook: 'Facebook',
  tiktok: 'TikTok',
  email: 'Email',
};
---

<footer id="footer" class="py-2 bg-[var(--color-bg-inverse)] text-[var(--color-text-inverse)]">
  <div class="max-w-[1100px] mx-auto px-4 lg:px-10">
    <!-- Main Footer Row -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-4">
      <!-- Brand Column -->
      <div class="lg:col-span-2">
        <h3 class="font-black text-xl lg:text-2xl tracking-tight mb-1">{operatorName}</h3>
        {(tagline || location) && (
          <p class="font-mono text-[8px] uppercase tracking-[0.1em] text-[var(--color-text-inverse)]/50">
            {tagline}{tagline && location ? ' — ' : ''}{location}
          </p>
        )}
      </div>

      <!-- Navigation Links -->
      {links.length > 0 && (
        <div>
          <p class="font-mono text-[9px] uppercase tracking-[0.12em] text-[var(--color-text-inverse)]/50 mb-4">
            {navLabel}
          </p>
          <ul class="space-y-2">
            {links.map((link: any) => (
              <li>
                <a 
                  href={link.href ?? '#'} 
                  class="text-[var(--color-text-inverse)]/70 hover:text-[var(--color-text-inverse)] transition-colors duration-200 text-sm"
                >
                  {link.label}
                </a>
              </li>
            ))}
          </ul>
        </div>
      )}

      <!-- Social Links -->
      {socialLinks.length > 0 && (
        <div>
          <p class="font-mono text-[9px] uppercase tracking-[0.12em] text-[var(--color-text-inverse)]/50 mb-4">
            {socialLabel}
          </p>
          <ul class="space-y-2">
            {socialLinks.map((social: any) => (
              <li>
                <a 
                  href={social.url ?? '#'} 
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-[var(--color-text-inverse)]/70 hover:text-[var(--color-text-inverse)] transition-colors duration-200 text-sm inline-flex items-center gap-2"
                >
                  {socialLabels[social.platform] ?? social.platform}
                  <svg class="w-3 h-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                  </svg>
                </a>
              </li>
            ))}
          </ul>
        </div>
      )}
    </div>

    <!-- Divider -->
    <div class="border-t border-[var(--color-text-inverse)]/10 pt-6">
      <div class="flex flex-col md:flex-row justify-between items-center gap-4">
        <p class="text-xs text-[var(--color-text-inverse)]/40">{copyright}</p>
        
        {legalLinks.length > 0 && (
          <div class="flex gap-6">
            {legalLinks.map((link: any) => (
              <a 
                href={link.href ?? '#'} 
                class="text-xs text-[var(--color-text-inverse)]/40 hover:text-[var(--color-text-inverse)]/70 transition-colors"
              >
                {link.label}
              </a>
            ))}
          </div>
        )}
      </div>
    </div>
  </div>
</footer>
